# UI設計ドキュメント

## コンセプト: 「VSCode風 Puzzle Workspace」

VSCodeのような使い慣れたレイアウトをベースに、パズル配置とジェスチャー操作を融合。
**デスクトップファースト**で最小の操作で最大の効果を。

---

## 設計思想

### 1. VSCode風レイアウト
- **アクティビティバー**（左端）: 主要機能への即座アクセス
- **サイドバー**（左）: 階層ツリー表示（Explorer風）
- **エディタエリア**（中央）: タブ + 分割可能
- **パネル**（下部）: タスク、検索結果など
- **コマンドパレット**: `Ctrl+P` で何でも検索

### 2. 階層構造の視覚化
- プロジェクト/ノートをツリー表示
- ドラッグで親子関係を変更
- インデントで深さを表現
- 折りたたみ/展開

### 3. パズル配置
- エディタエリアをグリッド分割
- ウィジェットを自由配置
- ドラッグでサイズ変更
- 複数レイアウトを保存

### 4. グローバルゴミ箱
- ヘッダー右上に常時表示
- どこからでもドラッグでドロップ可能
- クリックでゴミ箱パネル表示

---

## 画面構成

```
┌──┬────────────────────────────────────────────────────────────────────────┐
│  │ [📝 ノート1] [📝 ノート2] [×]      🔍 Ctrl+P     [+新規] [🗑️] ⚙️  👤 │
│  ├────────────────────────────────────────────────────────────────────────┤
│  │┌──────────────────────┐┌──────────────────────────────────────────────┐│
│📁││ EXPLORER          [+]││                                              ││
│  ││                      ││              エディタエリア                   ││
│🏷️ ││ ▼ 📁 仕事           ││          （パズルグリッド配置可能）          ││
│  ││   ├── 📝 会議メモ    ││                                              ││
│📅││   ├── 📝 企画書      ││  ┌────────────┐  ┌────────────────────────┐ ││
│  ││   └── 📁 Q4プロジェクト│  │  ノート     │  │    ノートエディタ      │ ││
│✅││       ├── 📝 計画    ││  │  カード     │  │                        │ ││
│  ││       └── 📝 進捗    ││  │  グリッド   │  │    # 会議メモ          │ ││
│🔧││ ▶ 📁 個人           ││  │             │  │                        │ ││
│  ││ ▶ 📁 アイデア       ││  │             │  │    - 議題1             │ ││
│  ││                      ││  └────────────┘  │    - 議題2             │ ││
│  ││ ──────────────────  ││                   │                        │ ││
│  ││ 🏷️ タグ             ││  ┌────────────┐  └────────────────────────┘ ││
│  ││   #重要 (5)         ││  │  カレンダー │                             ││
│  ││   #買い物 (3)       ││  │  ウィジェット│                             ││
│  ││                      ││  │             │                             ││
│  │└──────────────────────┘│  └────────────┘                             ││
│  │├──────────────────────────────────────────────────────────────────────┤│
│  ││ パネル: [タスク] [検索] [出力]                                       ││
│  ││ □ レポート提出 (12/20)  □ メール返信  ☑ 買い物                      ││
│  │└──────────────────────────────────────────────────────────────────────┘│
└──┴────────────────────────────────────────────────────────────────────────┘
  ↑                                                       ↑
アクティビティバー                                   ヘッダー右上にゴミ箱
```

---

## コンポーネント詳細

### 1. アクティビティバー（左端 48px）

```
┌────┐
│ 📁 │ ← Explorer（ノート/プロジェクト階層）
├────┤
│ 🏷️ │ ← タグ
├────┤
│ 📅 │ ← カレンダー/イベント
├────┤
│ ✅ │ ← タスク
├────┤
│    │
│    │
│    │
├────┤
│ 🔧 │ ← 設定
└────┘
```

- クリックでサイドバー内容切替
- ダブルクリックでサイドバー開閉
- バッジで未読/未完了数を表示

### 2. サイドバー（左 250px、リサイズ可能）

#### Explorer ビュー（階層ツリー）
```
┌────────────────────────────┐
│ EXPLORER                [+]│ ← ヘッダー + 新規作成
├────────────────────────────┤
│ ▼ 📁 仕事                  │
│   ├── 📝 会議メモ          │
│   ├── 📝 企画書            │
│   └── ▼ 📁 Q4計画         │
│       ├── 📝 目標          │
│       ├── 📝 予算          │
│       └── 📝 人員          │
│ ▶ 📁 個人                  │ ← クリックで展開
│ ▶ 📁 アイデア              │
│ ─────────────────────────  │
│ 📝 未分類ノート1           │ ← プロジェクトなし
│ 📝 未分類ノート2           │
└────────────────────────────┘
```

**階層操作:**
- ドラッグでノートを別プロジェクトへ移動
- ドラッグでプロジェクトの親子関係変更
- **ドラッグでヘッダー右上の🗑️にドロップで削除**
- 右クリックでコンテキストメニュー（削除オプションあり）
- F2 でリネーム
- Delete キーでゴミ箱へ

#### タグビュー
```
┌────────────────────────────┐
│ TAGS                   [+]│
├────────────────────────────┤
│ 🏷️ #重要 (5)               │
│   ├── 📝 会議メモ          │
│   ├── 📝 企画書            │
│   └── ...                  │
│ 🏷️ #仕事 (12)              │
│ 🏷️ #買い物 (3)             │
│ 🏷️ #アイデア (8)           │
│ ─────────────────────────  │
│ [+ 新しいタグ]             │
└────────────────────────────┘
```

### 3. ヘッダーバー（タブ + グローバルアクション）

```
┌─────────────────────────────────────────────────────────────────────────┐
│ [📝 会議メモ ×] [📝 企画書 ×] [+]   🔍 Ctrl+P    [+新規] [🗑️] ⚙️  👤  │
└─────────────────────────────────────────────────────────────────────────┘
  └──── タブエリア ────┘              └── グローバルアクション（右上）──┘
```

**右上のグローバルアクション:**
| アイコン | 機能 | 説明 |
|---------|------|------|
| `🔍 Ctrl+P` | 検索 | コマンドパレットを開く |
| `[+新規]` | 新規作成 | ノート/プロジェクト作成メニュー |
| `[🗑️]` | **ゴミ箱** | クリックでゴミ箱パネル、ドロップで削除 |
| `⚙️` | 設定 | 設定パネルを開く |
| `👤` | アカウント | プロフィール/ログアウト |

- ドラッグでタブ順序変更
- ドラッグでエディタ分割
- 中クリックで閉じる
- `Ctrl+W` で閉じる
- `Ctrl+Tab` で切替

### 4. エディタエリア（パズルグリッド）

#### 通常モード
```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  ┌──────────────────┐  ┌────────────────────────────────────┐  │
│  │ 📝 会議メモ      │  │  # 会議メモ                        │  │
│  │                  │  │                                    │  │
│  │  ## 議題         │  │  ## 本日の議題                     │  │
│  │  - 予算          │  │                                    │  │
│  │  - 人員          │  │  - 予算について                    │  │
│  │                  │  │  - 人員配置                        │  │
│  │  📅 12/20 14:00  │  │  - 来期計画                        │  │
│  │  #仕事 #重要     │  │                                    │  │
│  │                  │  │  ### 決定事項                      │  │
│  └──────────────────┘  │                                    │  │
│                        │  > 予算は前年比10%増で承認         │  │
│  ┌──────────────────┐  │                                    │  │
│  │ 📝 企画書        │  │  ---                               │  │
│  │  ...             │  │  📎 添付: [資料.pdf] [図表.xlsx]   │  │
│  │                  │  │  🏷️ #仕事 #重要 [+]                │  │
│  └──────────────────┘  └────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

※ 削除はカード/エディタをヘッダー右上の🗑️にドラッグ、または右クリックメニューから

#### 分割モード（VSCode風）
```
┌────────────────────────────┬────────────────────────────┐
│ [📝 会議メモ ×]            │ [📝 企画書 ×]              │
├────────────────────────────┼────────────────────────────┤
│                            │                            │
│  # 会議メモ                │  # 企画書                  │
│                            │                            │
│  ## 議題                   │  ## 概要                   │
│  - 予算                    │  ...                       │
│                            │                            │
└────────────────────────────┴────────────────────────────┘
```

#### パズル配置モード（Ctrl+Shift+L で切替）
```
┌─────────────────────────────────────────────────────────────────┐
│ 🧩 レイアウト編集中                          [保存] [リセット]  │
├─────────────────────────────────────────────────────────────────┤
│ ╔═══════════════════╗ ╔═════════════════════════════════════╗  │
│ ║ [≡] ノートリスト  ║ ║ [≡] エディタ                        ║  │
│ ║                   ║ ║                                     ║  │
│ ║                   ║ ║                                     ║  │
│ ║              [◢]  ║ ║                                [◢]  ║  │
│ ╚═══════════════════╝ ╚═════════════════════════════════════╝  │
│ ╔═══════════════════╗ ╔═════════════════════════════════════╗  │
│ ║ [≡] カレンダー    ║ ║ [≡] タスク                          ║  │
│ ║              [◢]  ║ ║                                [◢]  ║  │
│ ╚═══════════════════╝ ╚═════════════════════════════════════╝  │
├─────────────────────────────────────────────────────────────────┤
│ 追加: [📝ノート] [📅カレンダー] [✅タスク] [🏷️タグ] [📊統計]   │
└─────────────────────────────────────────────────────────────────┘
```

### 5. 下部パネル（高さ調整可能）

```
┌─────────────────────────────────────────────────────────────────────────┐
│ [タスク] [検索結果]                                     [−] [□] [×] │
├─────────────────────────────────────────────────────────────────────────┤
│ □ レポート提出      📅 12/20   ⚡高    仕事 > Q4計画                      │
│ □ メール返信        📅 12/18   ⚡中    仕事                               │
│ ☑ 買い物リスト作成  📅 12/15   ⚡低    個人          ← 完了済み           │
│ □ 企画書レビュー    📅 12/22   ⚡高    仕事 > Q4計画                      │
└─────────────────────────────────────────────────────────────────────────┘
```

※ タスクの削除は右クリックメニュー、またはヘッダー右上の🗑️にドラッグ

### 6. コマンドパレット（Ctrl+P）

```
┌───────────────────────────────────────────────────────────────┐
│ >  ____________________________________________               │
├───────────────────────────────────────────────────────────────┤
│ 📝 会議メモ                          仕事 > Q4計画           │
│ 📝 企画書                            仕事                    │
│ 📁 Q4計画プロジェクト                                        │
│ 🏷️ #重要                                                     │
│ ───────────────────────────────────────────────────────────  │
│ > 新しいノートを作成                                         │
│ > 新しいプロジェクトを作成                                   │
│ > レイアウトを変更                                           │
│ > 設定を開く                                                 │
└───────────────────────────────────────────────────────────────┘
```

---

## 階層構造の操作

### ドラッグ&ドロップで階層変更

```
操作前:
├── 📁 仕事
│   └── 📝 会議メモ
├── 📁 個人

「会議メモ」を「個人」にドラッグ:

├── 📁 仕事
├── 📁 個人
│   └── 📝 会議メモ  ← 移動完了
```

### インデントで深さ表現

```
├── 📁 プロジェクトA        ← Level 0
│   ├── 📝 ノート1          ← Level 1
│   ├── 📁 サブプロジェクト ← Level 1
│   │   ├── 📝 ノート2      ← Level 2
│   │   └── 📝 ノート3      ← Level 2
│   └── 📝 ノート4          ← Level 1
```

### 視覚的フィードバック

```
ドラッグ中:
├── 📁 仕事
│   └── 📝 会議メモ ─────────────┐ ドラッグ中
├── 📁 個人                      │
│   ┌─────────────────────────┐ │
│   │ ここにドロップ (子として) │◄┘
│   └─────────────────────────┘
│   ┌─────────────────────────┐
│   │ ここにドロップ (後に)    │
│   └─────────────────────────┘
```

---

## グローバルゴミ箱システム

### 配置場所

**ヘッダー右上に統一配置** - どの画面からでも視認・アクセス可能

```
┌─────────────────────────────────────────────────────────────────────┐
│ [タブ...]                           🔍 Ctrl+P  [+新規] [🗑️] ⚙️  👤 │
└─────────────────────────────────────────────────────────────────────┘
                                                      ↑
                                                グローバルゴミ箱
```

### 削除操作

| 操作方法 | 説明 |
|---------|------|
| ドラッグ→🗑️ | アイテムをヘッダー右上のゴミ箱にドロップ |
| 右クリック→削除 | コンテキストメニューから削除 |
| Delete キー | 選択中のアイテムを削除 |
| 🗑️ クリック | ゴミ箱パネルを開く |

### 操作フロー

```
1. アイテムをドラッグ開始
   ├── 📝 会議メモ ─────────→ [🗑️] ← ヘッダー右上が強調表示

2. ゴミ箱にドロップ
   └── 🗑️ (吸い込みアニメーション)

3. 削除完了
   └── Toast: 「ゴミ箱に移動しました [元に戻す]」
```

### ゴミ箱の状態表示

```
空:       🗑️  (グレー・細い)
1-5件:    🗑️  (通常)
6件以上:  🗑️• (バッジ表示)
ドラッグ中: 🗑️  (拡大 + 赤枠で強調)
ドロップ:  🗑️  (吸い込みアニメーション)
```

### ゴミ箱パネル（クリックで表示）

```
┌──────────────────────────────────────────────┐
│ 🗑️ ゴミ箱                            [全削除]│
├──────────────────────────────────────────────┤
│ 📝 会議メモ       削除: 5分前    [復元] [×]  │
│ 📁 古いプロジェクト 削除: 1時間前 [復元] [×]  │
│ 📝 下書き         削除: 昨日     [復元] [×]  │
├──────────────────────────────────────────────┤
│ ※ 30日後に自動削除されます                   │
└──────────────────────────────────────────────┘
```

---

## キーボードショートカット

| ショートカット | 動作 |
|--------------|------|
| `Ctrl+P` | コマンドパレット |
| `Ctrl+N` | 新しいノート |
| `Ctrl+Shift+N` | 新しいプロジェクト |
| `Ctrl+S` | 保存 |
| `Ctrl+W` | タブを閉じる |
| `Ctrl+Tab` | 次のタブ |
| `Ctrl+B` | サイドバー開閉 |
| `Ctrl+J` | パネル開閉 |
| `Ctrl+\` | エディタ分割 |
| `Ctrl+Shift+L` | レイアウト編集モード |
| `Delete` | 選択アイテムをゴミ箱へ |
| `Ctrl+Z` | 元に戻す |
| `F2` | リネーム |

---

## カラースキーム（VSCode風）

### ダークモード（デフォルト）
```css
--bg-activity-bar: #333333;
--bg-sidebar: #252526;
--bg-editor: #1e1e1e;
--bg-panel: #1e1e1e;
--bg-tab-active: #1e1e1e;
--bg-tab-inactive: #2d2d2d;
--border: #3c3c3c;
--text-primary: #cccccc;
--text-secondary: #858585;
--accent: #0078d4;
--accent-hover: #1e90ff;
--danger: #f14c4c;
--success: #4ec9b0;
--warning: #cca700;
```

### ライトモード
```css
--bg-activity-bar: #2c2c2c;
--bg-sidebar: #f3f3f3;
--bg-editor: #ffffff;
--bg-panel: #f3f3f3;
--bg-tab-active: #ffffff;
--bg-tab-inactive: #ececec;
--border: #e5e5e5;
--text-primary: #333333;
--text-secondary: #6e6e6e;
--accent: #0078d4;
```

---

## アニメーション

| 要素 | アニメーション | 時間 |
|------|---------------|------|
| サイドバー開閉 | width 0↔250px | 150ms |
| パネル開閉 | height 0↔200px | 150ms |
| ツリー展開 | height + opacity | 200ms |
| タブ切替 | opacity | 100ms |
| ゴミ箱ドロップ | scale + rotate + fade | 300ms |
| ドラッグ中 | shadow + scale(1.02) | - |
| ホバー | background-color | 100ms |

---

## 利用可能ウィジェット

| ウィジェット | 最小サイズ | 説明 |
|-------------|-----------|------|
| ノートリスト | 1x2 | カード形式のノート一覧 |
| ノートエディタ | 2x2 | Tiptapエディタ |
| カレンダー | 2x2 | 月/週/日表示 |
| タスクリスト | 1x2 | 未完了タスク |
| タグクラウド | 1x1 | タグ一覧 |
| 最近のノート | 1x2 | アクセス履歴 |
| クイックメモ | 1x1 | 即座に入力 |
| プロジェクト進捗 | 2x1 | 進捗バー |

---

## 実装優先順位

> 詳細な実装手順は `frontend-implementation.md` を参照

### Phase 1: 基盤構築（3-4日）
1. shadcn/ui 初期化・コンポーネント追加
2. TanStack Query セットアップ
3. VSCode風レイアウト（アクティビティバー、サイドバー、エディタ）
4. 認証画面

### Phase 2: 階層構造（4-5日）
1. ツリービュー（プロジェクト/ノート階層）
2. ドラッグ&ドロップで階層変更
3. タブバー + エディタ
4. Tiptap エディタ統合

### Phase 3: ゴミ箱・操作（3-4日）
1. 分散ゴミ箱システム
2. コマンドパレット
3. キーボードショートカット
4. コンテキストメニュー

### Phase 4: パズルレイアウト（2-3日）
1. react-grid-layout 導入
2. ウィジェット定義
3. レイアウト編集モード
4. レイアウト保存/復元

### Phase 5: 拡張・最適化（2-3日）
1. 下部パネル（タスク、検索、ゴミ箱）
2. カレンダーウィジェット
3. エディタ分割
4. パフォーマンス最適化
